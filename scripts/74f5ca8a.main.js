function initializeMap(){var a=new google.maps.LatLng(center[0],center[1]);map=new google.maps.Map(document.getElementById("map-canvas"),{center:a,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP})}function createVehicleMarker(a,b){var c=new google.maps.Marker({icon:"https://chart.googleapis.com/chart?chst=d_bubble_icon_text_small&chld=mobile|bbT|"+a.name+"|"+b+"|eee",position:new google.maps.LatLng(a.lat,a.lon),optimized:!0,map:map});return c}function getVehicleColor(a){return"FF6450"}function coordinatesAreEquivalent(a,b){return Math.abs(a-b)<1e-6}if(function(a){var b,c;!function(){var a={},d={};b=function(b,c,d){a[b]={deps:c,callback:d}},c=function(b){function e(a){if("."!==a.charAt(0))return a;for(var c=a.split("/"),d=b.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(d[b])return d[b];if(d[b]={},!a[b])throw new Error("Could not find module "+b);for(var f,g=a[b],h=g.deps,i=g.callback,j=[],k=0,l=h.length;l>k;k++)"exports"===h[k]?j.push(f={}):j.push(c(e(h[k])));var m=i.apply(this,j);return d[b]=f||m},c.entries=a}(),b("rsvp/-internal",["./utils","./instrument","./config","exports"],function(a,b,c,d){"use strict";function e(){}function f(a){try{return a.then}catch(b){return B.error=b,B}}function g(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function h(a,b,c){x.async(function(a){var d=!1,e=g(c,b,function(c){d||(d=!0,b!==c?k(a,c):m(a,c))},function(b){d||(d=!0,n(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,n(a,e))},a)}function i(a,b){a._onerror=null,b._state===z?m(a,b._result):a._state===A?n(a,b._result):o(b,void 0,function(c){b!==c?k(a,c):m(a,c)},function(b){n(a,b)})}function j(a,b){if(b instanceof a.constructor)i(a,b);else{var c=f(b);c===B?n(a,B.error):void 0===c?m(a,b):v(c)?h(a,b,c):m(a,b)}}function k(a,b){a===b?m(a,b):u(b)?j(a,b):m(a,b)}function l(a){a._onerror&&a._onerror(a._result),p(a)}function m(a,b){a._state===y&&(a._result=b,a._state=z,0===a._subscribers.length?x.instrument&&w("fulfilled",a):x.async(p,a))}function n(a,b){a._state===y&&(a._state=A,a._result=b,x.async(l,a))}function o(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+z]=c,e[f+A]=d,0===f&&a._state&&x.async(p,a)}function p(a){var b=a._subscribers,c=a._state;if(x.instrument&&w(c===z?"fulfilled":"rejected",a),0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?s(c,d,e,f):e(f);a._subscribers.length=0}}function q(){this.error=null}function r(a,b){try{return a(b)}catch(c){return C.error=c,C}}function s(a,b,c,d){var e,f,g,h,i=v(c);if(i){if(e=r(c,d),e===C?(h=!0,f=e.error,e=null):g=!0,b===e)return void n(b,new TypeError("A promises callback cannot return that same promise."))}else e=d,g=!0;b._state===y&&(i&&g?k(b,e):h?n(b,f):a===z?m(b,e):a===A&&n(b,e))}function t(a,b){try{b(function(b){k(a,b)},function(b){n(a,b)})}catch(c){n(a,c)}}var u=a.objectOrFunction,v=a.isFunction,w=(a.now,b["default"]),x=c.config,y=void 0,z=1,A=2,B=new q,C=new q;d.noop=e,d.resolve=k,d.reject=n,d.fulfill=m,d.subscribe=o,d.publish=p,d.publishRejection=l,d.initializePromise=t,d.invokeCallback=s,d.FULFILLED=z,d.REJECTED=A}),b("rsvp/all-settled",["./enumerator","./promise","./utils","exports"],function(a,b,c,d){"use strict";function e(a,b,c){this._superConstructor(a,b,!1,c)}var f=a["default"],g=a.makeSettledResult,h=b["default"],i=c.o_create;e.prototype=i(f.prototype),e.prototype._superConstructor=f,e.prototype._makeResult=g,e.prototype._validationError=function(){return new Error("allSettled must be called with an array")},d["default"]=function(a,b){return new e(h,a,b).promise}}),b("rsvp/all",["./promise","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a,b){return c.all(a,b)}}),b("rsvp/asap",["exports"],function(a){"use strict";function b(){return function(){process.nextTick(f)}}function c(){var a=0,b=new j(f),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function d(){var a=new MessageChannel;return a.port1.onmessage=f,function(){a.port2.postMessage(0)}}function e(){return function(){setTimeout(f,1)}}function f(){for(var a=0;g>a;a+=2){var b=l[a],c=l[a+1];b(c),l[a]=void 0,l[a+1]=void 0}g=0}var g=0;a["default"]=function(a,b){l[g]=a,l[g+1]=b,g+=2,2===g&&h()};var h,i="undefined"!=typeof window?window:{},j=i.MutationObserver||i.WebKitMutationObserver,k="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,l=new Array(1e3);h="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?b():j?c():k?d():e()}),b("rsvp/config",["./events","exports"],function(a,b){"use strict";function c(a,b){return"onerror"===a?void e.on("error",b):2!==arguments.length?e[a]:void(e[a]=b)}var d=a["default"],e={instrument:!1};d.mixin(e),b.config=e,b.configure=c}),b("rsvp/defer",["./promise","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a){var b={};return b.promise=new c(function(a,c){b.resolve=a,b.reject=c},a),b}}),b("rsvp/enumerator",["./utils","./-internal","exports"],function(a,b,c){"use strict";function d(a,b,c){return a===l?{state:"fulfilled",value:c}:{state:"rejected",reason:c}}function e(a,b,c,d){this._instanceConstructor=a,this.promise=new a(h,d),this._abortOnReject=c,this._validateInput(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._init(),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&j(this.promise,this._result))):i(this.promise,this._validationError())}var f=a.isArray,g=a.isMaybeThenable,h=b.noop,i=b.reject,j=b.fulfill,k=b.subscribe,l=b.FULFILLED,m=b.REJECTED,n=b.PENDING,o=!0;c.ABORT_ON_REJECTION=o,c.makeSettledResult=d,e.prototype._validateInput=function(a){return f(a)},e.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},e.prototype._init=function(){this._result=new Array(this.length)},c["default"]=e,e.prototype._enumerate=function(){for(var a=this.length,b=this.promise,c=this._input,d=0;b._state===n&&a>d;d++)this._eachEntry(c[d],d)},e.prototype._eachEntry=function(a,b){var c=this._instanceConstructor;g(a)?a.constructor===c&&a._state!==n?(a._onerror=null,this._settledAt(a._state,b,a._result)):this._willSettleAt(c.resolve(a),b):(this._remaining--,this._result[b]=this._makeResult(l,b,a))},e.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===n&&(this._remaining--,this._abortOnReject&&a===m?i(d,c):this._result[b]=this._makeResult(a,b,c)),0===this._remaining&&j(d,this._result)},e.prototype._makeResult=function(a,b,c){return c},e.prototype._willSettleAt=function(a,b){var c=this;k(a,void 0,function(a){c._settledAt(l,b,a)},function(a){c._settledAt(m,b,a)})}}),b("rsvp/events",["exports"],function(a){"use strict";function b(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}function c(a){var b=a._promiseCallbacks;return b||(b=a._promiseCallbacks={}),b}a["default"]={mixin:function(a){return a.on=this.on,a.off=this.off,a.trigger=this.trigger,a._promiseCallbacks=void 0,a},on:function(a,d){var e,f=c(this);e=f[a],e||(e=f[a]=[]),-1===b(e,d)&&e.push(d)},off:function(a,d){var e,f,g=c(this);return d?(e=g[a],f=b(e,d),-1!==f&&e.splice(f,1),void 0):void(g[a]=[])},trigger:function(a,b){var d,e,f=c(this);if(d=f[a])for(var g=0;g<d.length;g++)(e=d[g])(b)}}}),b("rsvp/filter",["./promise","./utils","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.isFunction;b.isMaybeThenable;c["default"]=function(a,b,c){return d.all(a,c).then(function(a){if(!e(b))throw new TypeError("You must pass a function as filter's second argument.");for(var f=a.length,g=new Array(f),h=0;f>h;h++)g[h]=b(a[h]);return d.all(g,c).then(function(b){for(var c=new Array(f),d=0,e=0;f>e;e++)b[e]&&(c[d]=a[e],d++);return c.length=d,c})})}}),b("rsvp/hash-settled",["./promise","./enumerator","./promise-hash","./utils","exports"],function(a,b,c,d,e){"use strict";function f(a,b,c){this._superConstructor(a,b,!1,c)}var g=a["default"],h=b.makeSettledResult,i=c["default"],j=b["default"],k=d.o_create;f.prototype=k(i.prototype),f.prototype._superConstructor=j,f.prototype._makeResult=h,f.prototype._validationError=function(){return new Error("hashSettled must be called with an object")},e["default"]=function(a,b){return new f(g,a,b).promise}}),b("rsvp/hash",["./promise","./promise-hash","./enumerator","exports"],function(a,b,c,d){"use strict";var e=a["default"],f=b["default"];c.ABORT_ON_REJECTION;d["default"]=function(a,b){return new f(e,a,b).promise}}),b("rsvp/instrument",["./config","./utils","exports"],function(a,b,c){"use strict";var d=a.config,e=b.now,f=[];c["default"]=function(a,b,c){1===f.push({name:a,payload:{guid:b._guidKey+b._id,eventName:a,detail:b._result,childGuid:c&&b._guidKey+c._id,label:b._label,timeStamp:e(),stack:new Error(b._label).stack}})&&setTimeout(function(){for(var a,b=0;b<f.length;b++)a=f[b],d.trigger(a.name,a.payload);f.length=0},50)}}),b("rsvp/map",["./promise","./utils","exports"],function(a,b,c){"use strict";var d=a["default"],e=(b.isArray,b.isFunction);c["default"]=function(a,b,c){return d.all(a,c).then(function(a){if(!e(b))throw new TypeError("You must pass a function as map's second argument.");for(var f=a.length,g=new Array(f),h=0;f>h;h++)g[h]=b(a[h]);return d.all(g,c)})}}),b("rsvp/node",["./promise","./utils","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.isArray;c["default"]=function(a,b){function c(){for(var c=arguments.length,e=new Array(c),h=0;c>h;h++)e[h]=arguments[h];var i;return f||g||!b?i=this:("object"==typeof console&&console.warn('Deprecation: RSVP.denodeify() doesn\'t allow setting the "this" binding anymore. Use yourFunction.bind(yourThis) instead.'),i=b),d.all(e).then(function(c){function e(d,e){function h(){for(var a=arguments.length,c=new Array(a),h=0;a>h;h++)c[h]=arguments[h];var i=c[0],j=c[1];if(i)e(i);else if(f)d(c.slice(1));else if(g){var k,l,m={},n=c.slice(1);for(l=0;l<b.length;l++)k=b[l],m[k]=n[l];d(m)}else d(j)}c.push(h),a.apply(i,c)}return new d(e)})}var f=b===!0,g=e(b);return c.__proto__=a,c}}),b("rsvp/promise-hash",["./enumerator","./-internal","./utils","exports"],function(a,b,c,d){"use strict";function e(a,b,c){this._superConstructor(a,b,!0,c)}var f=a["default"],g=b.PENDING,h=(b.FULFILLED,c.o_create);d["default"]=e,e.prototype=h(f.prototype),e.prototype._superConstructor=f,e.prototype._init=function(){this._result={}},e.prototype._validateInput=function(a){return a&&"object"==typeof a},e.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},e.prototype._enumerate=function(){var a=this.promise,b=this._input,c=[];for(var d in b)a._state===g&&b.hasOwnProperty(d)&&c.push({position:d,entry:b[d]});var e=c.length;this._remaining=e;for(var f,h=0;a._state===g&&e>h;h++)f=c[h],this._eachEntry(f.entry,f.position)}}),b("rsvp/promise",["./config","./events","./instrument","./utils","./-internal","./promise/cast","./promise/all","./promise/race","./promise/resolve","./promise/reject","exports"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function m(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function n(a,b){this._id=D++,this._label=b,this._subscribers=[],o.instrument&&p("created",this),s!==a&&(q(a)||l(),this instanceof n||m(),u(this,a))}var o=a.config,p=(b["default"],c["default"]),q=(d.objectOrFunction,d.isFunction),r=d.now,s=e.noop,t=(e.resolve,e.reject,e.fulfill,e.subscribe),u=e.initializePromise,v=e.invokeCallback,w=e.FULFILLED,x=f["default"],y=g["default"],z=h["default"],A=i["default"],B=j["default"],C="rsvp_"+r()+"-",D=0;k["default"]=n,n.cast=x,n.all=y,n.race=z,n.resolve=A,n.reject=B,n.prototype={constructor:n,_id:void 0,_guidKey:C,_label:void 0,_state:void 0,_result:void 0,_subscribers:void 0,_onerror:function(a){o.trigger("error",a)},then:function(a,b,c){var d=this;d._onerror=null;var e=new this.constructor(s,c),f=d._state,g=d._result;return o.instrument&&p("chained",d,e),f===w&&a?o.async(function(){v(f,e,a,g)}):t(d,e,a,b),e},"catch":function(a,b){return this.then(null,a,b)},"finally":function(a,b){var c=this.constructor;return this.then(function(b){return c.resolve(a()).then(function(){return b})},function(b){return c.resolve(a()).then(function(){throw b})},b)}}}),b("rsvp/promise/all",["../enumerator","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a,b){return new c(this,a,!0,b).promise}}),b("rsvp/promise/cast",["./resolve","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=c}),b("rsvp/promise/race",["../utils","../-internal","exports"],function(a,b,c){"use strict";var d=a.isArray,e=(a.isFunction,a.isMaybeThenable,b.noop),f=b.resolve,g=b.reject,h=b.subscribe,i=b.PENDING;c["default"]=function(a,b){function c(a){f(l,a)}function j(a){g(l,a)}var k=this,l=new k(e,b);if(!d(a))return g(l,new TypeError("You must pass an array to race.")),l;for(var m=a.length,n=0;l._state===i&&m>n;n++)h(k.resolve(a[n]),void 0,c,j);return l}}),b("rsvp/promise/reject",["../-internal","exports"],function(a,b){"use strict";var c=a.noop,d=a.reject;b["default"]=function(a,b){var e=this,f=new e(c,b);return d(f,a),f}}),b("rsvp/promise/resolve",["../-internal","exports"],function(a,b){"use strict";var c=a.noop,d=a.resolve;b["default"]=function(a,b){var e=this;if(a&&"object"==typeof a&&a.constructor===e)return a;var f=new e(c,b);return d(f,a),f}}),b("rsvp/race",["./promise","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a,b){return c.race(a,b)}}),b("rsvp/reject",["./promise","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a,b){return c.reject(a,b)}}),b("rsvp/resolve",["./promise","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a,b){return c.resolve(a,b)}}),b("rsvp/rethrow",["exports"],function(a){"use strict";a["default"]=function(a){throw setTimeout(function(){throw a}),a}}),b("rsvp/utils",["exports"],function(a){"use strict";function b(a){return"function"==typeof a||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){return"object"==typeof a&&null!==a}a.objectOrFunction=b,a.isFunction=c,a.isMaybeThenable=d;var e;e=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var f=e;a.isArray=f;var g=Date.now||function(){return(new Date).getTime()};a.now=g;var h=Object.create||function(a){var b=function(){};return b.prototype=a,b};a.o_create=h}),b("rsvp",["./rsvp/promise","./rsvp/events","./rsvp/node","./rsvp/all","./rsvp/all-settled","./rsvp/race","./rsvp/hash","./rsvp/hash-settled","./rsvp/rethrow","./rsvp/defer","./rsvp/config","./rsvp/map","./rsvp/resolve","./rsvp/reject","./rsvp/filter","./rsvp/asap","exports"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";function r(a,b){E.async(a,b)}function s(){E.on.apply(E,arguments)}function t(){E.off.apply(E,arguments)}var u=a["default"],v=b["default"],w=c["default"],x=d["default"],y=e["default"],z=f["default"],A=g["default"],B=h["default"],C=i["default"],D=j["default"],E=k.config,F=k.configure,G=l["default"],H=m["default"],I=n["default"],J=o["default"],K=p["default"];if(E.async=K,"undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var L=window.__PROMISE_INSTRUMENTATION__;F("instrument",!0);for(var M in L)L.hasOwnProperty(M)&&s(M,L[M])}q.Promise=u,q.EventTarget=v,q.all=x,q.allSettled=y,q.race=z,q.hash=A,q.hashSettled=B,q.rethrow=C,q.defer=D,q.denodeify=w,q.configure=F,q.on=s,q.off=t,q.resolve=H,q.reject=I,q.async=r,q.map=G,q.filter=J}),a.RSVP=c("rsvp")}(self),"undefined"!=typeof module&&"undefined"!=typeof process)var RSVP=require("rsvp");var GeoFire=function(){"use strict";function a(a,b){return o(a),p(b),{".priority":b,g:b,l:a}}function b(a){if(null!==a&&a.hasOwnProperty("l")&&Array.isArray(a.l)&&2===a.l.length)return a.l;throw new Error("Unexpected GeoFire location object encountered: "+JSON.stringify(a))}var c=function(a){if(this.cancel=function(){"undefined"!=typeof b&&(b(),b=void 0)},"function"!=typeof a)throw new Error("callback must be a function");var b=a},d=function(c){if(this.ref=function(){return d},this.set=function(b,c){var e;if("string"==typeof b&&0!==b.length)e={},e[b]=c;else{if("object"!=typeof b)throw new Error("keyOrLocations must be a string or a mapping of key - location pairs.");if("undefined"!=typeof c)throw new Error("The location argument should not be used if you pass an object to set().");e=b}var f={};return Object.keys(e).forEach(function(b){n(b);var c=e[b];if(null===c)f[b]=null;else{o(c);var d=s(c);f[b]=a(c,d)}}),new RSVP.Promise(function(a,b){function c(c){null!==c?b("Error: Firebase synchronization failed: "+c):a()}d.update(f,c)})},this.get=function(a){return n(a),new RSVP.Promise(function(c,e){d.child(a).once("value",function(a){c(null===a.val()?null:b(a.val()))},function(a){e("Error: Firebase synchronization failed: "+a)})})},this.remove=function(a){return this.set(a,null)},this.query=function(a){return new B(d,a)},"[object Object]"!==Object.prototype.toString.call(c))throw new Error("firebaseRef must be an instance of Firebase");var d=c};d.distance=function(a,b){o(a),o(b);var c=6371,d=r(b[0]-a[0]),e=r(b[1]-a[1]),f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(r(a[0]))*Math.cos(r(b[0]))*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f));return c*g};var e=10,f="0123456789bcdefghjkmnpqrstuvwxyz",g=40007860,h=110574,i=5,j=22*i,k=6378137,l=.00669447819799,m=1e-12;Math.log2=Math.log2||function(a){return Math.log(a)/Math.log(2)};var n=function(a){var b;if("string"!=typeof a?b="key must be a string":0===a.length?b="key cannot be the empty string":1+e+a.length>755?b="key is too long to be stored in Firebase":/[\[\].#$\/\u0000-\u001F\u007F]/.test(a)&&(b="key cannot contain any of the following characters: . # $ ] [ /"),"undefined"!=typeof b)throw new Error("Invalid GeoFire key '"+a+"': "+b)},o=function(a){var b;if(Array.isArray(a))if(2!==a.length)b="expected array of length 2, got length "+a.length;else{var c=a[0],d=a[1];"number"!=typeof c||isNaN(c)?b="latitude must be a number":-90>c||c>90?b="latitude must be within the range [-90, 90]":"number"!=typeof d||isNaN(d)?b="longitude must be a number":(-180>d||d>180)&&(b="longitude must be within the range [-180, 180]")}else b="location must be an array";if("undefined"!=typeof b)throw new Error("Invalid GeoFire location '"+a+"': "+b)},p=function(a){var b;if("string"!=typeof a)b="geohash must be a string";else if(0===a.length)b="geohash cannot be the empty string";else for(var c=0,d=a.length;d>c;++c)-1===f.indexOf(a[c])&&(b='geohash cannot contain "'+a[c]+'"');if("undefined"!=typeof b)throw new Error("Invalid GeoFire geohash '"+a+"': "+b)},q=function(a,b){if("object"!=typeof a)throw new Error("query criteria must be an object");if("undefined"==typeof a.center&&"undefined"==typeof a.radius)throw new Error("radius and/or center must be specified");if(b&&("undefined"==typeof a.center||"undefined"==typeof a.radius))throw new Error("query criteria for a new query must contain both a center and a radius");for(var c=Object.keys(a),d=c.length,e=0;d>e;++e){var f=c[e];if("center"!==f&&"radius"!==f)throw new Error("Unexpected attribute '"+f+"'' found in query criteria")}if("undefined"!=typeof a.center&&o(a.center),"undefined"!=typeof a.radius){if("number"!=typeof a.radius||isNaN(a.radius))throw new Error("radius must be a number");if(a.radius<0)throw new Error("radius must be greater than or equal to 0")}},r=function(a){if("number"!=typeof a||isNaN(a))throw new Error("Error: degrees must be a number");return a*Math.PI/180},s=function(a,b){if(o(a),"undefined"!=typeof b){if("number"!=typeof b||isNaN(b))throw new Error("precision must be a number");if(0>=b)throw new Error("precision must be greater than 0");if(b>22)throw new Error("precision cannot be greater than 22");if(Math.round(b)!==b)throw new Error("precision must be an integer")}b=b||e;for(var c={min:-90,max:90},d={min:-180,max:180},g="",h=0,i=0,j=1;g.length<b;){var k=j?a[1]:a[0],l=j?d:c,m=(l.min+l.max)/2;k>m?(h=(h<<1)+1,l.min=m):(h=(h<<1)+0,l.max=m),j=!j,4>i?i++:(i=0,g+=f[h],h=0)}return g},t=function(a,b){var c=r(b),d=Math.cos(c)*k*Math.PI/180,e=1/Math.sqrt(1-l*Math.sin(c)*Math.sin(c)),f=d*e;return m>f?a>0?360:0:Math.min(360,a/f)},u=function(a,b){var c=t(a,b);return Math.abs(c)>1e-6?Math.max(1,Math.log2(360/c)):1},v=function(a){return Math.min(Math.log2(g/2/a),j)},w=function(a){if(180>=a&&a>=-180)return a;var b=a+180;return b>0?b%360-180:180- -b%360},x=function(a,b){var c=b/h,d=Math.min(90,a[0]+c),e=Math.max(-90,a[0]-c),f=2*Math.floor(v(b)),g=2*Math.floor(u(b,d))-1,i=2*Math.floor(u(b,e))-1;return Math.min(f,g,i,j)},y=function(a,b){var c=b/h,d=Math.min(90,a[0]+c),e=Math.max(-90,a[0]-c),f=t(b,d),g=t(b,e),i=Math.max(f,g);return[[a[0],a[1]],[a[0],w(a[1]-i)],[a[0],w(a[1]+i)],[d,a[1]],[d,w(a[1]-i)],[d,w(a[1]+i)],[e,a[1]],[e,w(a[1]-i)],[e,w(a[1]+i)]]},z=function(a,b){p(a);var c=Math.ceil(b/i);if(a.length<c)return[a,a+"~"];a=a.substring(0,c);var d=a.substring(0,a.length-1),e=f.indexOf(a.charAt(a.length-1)),g=b-d.length*i,h=i-g,j=e>>h<<h,k=j+(1<<h);return k>31?[d+f[j],d+"~"]:[d+f[j],d+f[k]]},A=function(a,b){o(a);var c=Math.max(1,x(a,b)),d=Math.ceil(c/i),e=y(a,b),f=e.map(function(a){return z(s(a,d),c)});return f.filter(function(a,b){return!f.some(function(c,d){return b>d&&a[0]===c[0]&&a[1]===c[1]})})},B=function(a,f){function g(a,b,c,d){z[a].forEach(function(a){"undefined"==typeof c||null===c?a(b,null,null):a(b,c,d)})}function h(){z.ready.forEach(function(a){a()})}function i(a){var b=a.split(":");if(2!==b.length)throw new Error("Invalid internal state! Not a valid geohash query: "+a);return b}function j(a){if(2!==a.length)throw new Error("Not a valid geohash query: "+a);return a[0]+":"+a[1]}function k(a,b){var c=y.orderByChild("g").startAt(a[0]).endAt(a[1]);c.off("child_added",b.childAddedCallback),c.off("child_removed",b.childRemovedCallback),c.off("child_changed",b.childChangedCallback),c.off("value",b.valueCallback)}function l(){for(var a=Object.keys(D),b=a.length,c=0;b>c;++c){var d=a[c],e=D[d];if(e.active===!1){var f=i(d);k(f,e),delete D[d]}}for(a=Object.keys(C),b=a.length,c=0;b>c;++c){var g=a[c];if(!n(C[g].geohash)){if(C[g].isInQuery)throw new Error("Internal State error, trying to remove location that is still in query");delete C[g]}}E=!1,null!==F&&(clearTimeout(F),F=null)}function m(a,b){o(b);var c,f,h=C.hasOwnProperty(a)?C[a].isInQuery:!1,i=C.hasOwnProperty(a)?C[a].location:null;c=d.distance(b,H),f=I>=c,C[a]={location:b,distanceFromCenter:c,isInQuery:f,geohash:s(b,e)},f&&!h?g("key_entered",a,b,c):!f||null===i||b[0]===i[0]&&b[1]===i[1]?!f&&h&&g("key_exited",a,b,c):g("key_moved",a,b,c)}function n(a){for(var b=Object.keys(D),c=b.length,d=0;c>d;++d){var e=b[d];if(D.hasOwnProperty(e)){var f=i(e);if(a>=f[0]&&a<=f[1])return!0}}return!1}function p(a,b){var c=C[a];if(delete C[a],"undefined"!=typeof c&&c.isInQuery){var e=b?d.distance(b,H):null;g("key_exited",a,b,e)}}function r(a){m(a.key(),b(a.val()))}function t(a){m(a.key(),b(a.val()))}function u(a){var c=a.key();C.hasOwnProperty(c)&&y.child(c).once("value",function(a){var d=null===a.val()?null:b(a.val()),e=null!==d?s(d):null;n(e)||p(c,d)})}function v(a){var b=x.indexOf(a);b>-1&&x.splice(b,1),B=0===x.length,B&&h()}function w(){var a=A(H,1e3*I).map(j);a=a.filter(function(b,c){return a.indexOf(b)===c});for(var b=Object.keys(D),c=b.length,d=0;c>d;++d){var e=b[d],f=a.indexOf(e);-1===f?D[e].active=!1:(D[e].active=!0,a.splice(f,1))}E===!1&&Object.keys(D).length>25&&(E=!0,F=setTimeout(l,10)),x=a.slice(),a.forEach(function(a){var b=i(a),c=y.orderByChild("g").startAt(b[0]).endAt(b[1]),d=c.on("child_added",r),e=c.on("child_removed",u),f=c.on("child_changed",t),g=c.on("value",function(){c.off("value",g),v(a)});D[a]={active:!0,childAddedCallback:d,childRemovedCallback:e,childChangedCallback:f,valueCallback:g}}),0===a.length&&v()}if(this.center=function(){return H},this.radius=function(){return I},this.updateCriteria=function(a){q(a),H=a.center||H,I=a.radius||I;for(var b=Object.keys(C),c=b.length,e=0;c>e;++e){var f=b[e],h=C[f],i=h.isInQuery;h.distanceFromCenter=d.distance(h.location,H),h.isInQuery=h.distanceFromCenter<=I,i&&!h.isInQuery?g("key_exited",f,h.location,h.distanceFromCenter):!i&&h.isInQuery&&g("key_entered",f,h.location,h.distanceFromCenter)}B=!1,w()},this.on=function(a,b){if(-1===["ready","key_entered","key_exited","key_moved"].indexOf(a))throw new Error('event type must be "ready", "key_entered", "key_exited", or "key_moved"');if("function"!=typeof b)throw new Error("callback must be a function");if(z[a].push(b),"key_entered"===a)for(var d=Object.keys(C),e=d.length,f=0;e>f;++f){var g=d[f],h=C[g];"undefined"!=typeof h&&h.isInQuery&&b(g,h.location,h.distanceFromCenter)}return"ready"===a&&B&&b(),new c(function(){z[a].splice(z[a].indexOf(b),1)})},this.cancel=function(){z={ready:[],key_entered:[],key_exited:[],key_moved:[]};for(var a=Object.keys(D),b=a.length,c=0;b>c;++c){var d=a[c],e=i(d);k(e,D[d]),delete D[d]}C={},clearInterval(G)},"[object Object]"!==Object.prototype.toString.call(a))throw new Error("firebaseRef must be an instance of Firebase");var x,y=a,z={ready:[],key_entered:[],key_exited:[],key_moved:[]},B=!1,C={},D={},E=!1,F=null,G=setInterval(function(){E===!1&&l()},1e4);q(f,!0);var H=f.center,I=f.radius;w()};return d}();"undefined"!=typeof module&&"undefined"!=typeof process&&(module.exports=GeoFire),function(){function a(a,b,c){c=(c||0)-1;for(var d=a?a.length:0;++c<d;)if(a[c]===b)return c;return-1}function b(b,c){var d=typeof c;if(b=b.l,"boolean"==d||null==c)return b[c]?0:-1;"number"!=d&&"string"!=d&&(d="object");var e="number"==d?c:r+c;return b=(b=b[d])&&b[e],"object"==d?b&&-1<a(b,c)?0:-1:b?0:-1}function c(a){var b=this.l,c=typeof a;if("boolean"==c||null==a)b[a]=!0;else{"number"!=c&&"string"!=c&&(c="object");var d="number"==c?a:r+a,b=b[c]||(b[c]={});"object"==c?(b[d]||(b[d]=[])).push(a):b[d]=!0}}function d(a){return a.charCodeAt(0)}function e(a,b){for(var c=a.m,d=b.m,e=-1,f=c.length;++e<f;){var g=c[e],h=d[e];if(g!==h){if(g>h||"undefined"==typeof g)return 1;if(h>g||"undefined"==typeof h)return-1}}return a.n-b.n}function f(a){var b=-1,d=a.length,e=a[0],f=a[d/2|0],g=a[d-1];if(e&&"object"==typeof e&&f&&"object"==typeof f&&g&&"object"==typeof g)return!1;for(e=i(),e["false"]=e["null"]=e["true"]=e.undefined=!1,f=i(),f.k=a,f.l=e,f.push=c;++b<d;)f.push(a[b]);return f}function g(a){return"\\"+U[a]}function h(){return o.pop()||[]}function i(){return p.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function j(a){a.length=0,o.length<t&&o.push(a)}function k(a){var b=a.l;b&&k(b),a.k=a.l=a.m=a.object=a.number=a.string=a.o=null,p.length<t&&p.push(a)}function l(a,b,c){b||(b=0),"undefined"==typeof c&&(c=a?a.length:0);var d=-1;c=c-b||0;for(var e=Array(0>c?0:c);++d<c;)e[d]=a[b+d];return e}function m(c){function o(a,b,c){if(!a||!T[typeof a])return a;b=b&&"undefined"==typeof c?b:ba(b,c,3);for(var d=-1,e=T[typeof a]&&Kb(a),f=e?e.length:0;++d<f&&(c=e[d],!1!==b(a[c],c,a)););return a}function p(a,b,c){var d;if(!a||!T[typeof a])return a;b=b&&"undefined"==typeof c?b:ba(b,c,3);for(d in a)if(!1===b(a[d],d,a))break;return a}function t(a,b,c){var d,e=a,f=e;if(!e)return f;for(var g=arguments,h=0,i="number"==typeof c?2:g.length;++h<i;)if((e=g[h])&&T[typeof e])for(var j=-1,k=T[typeof e]&&Kb(e),l=k?k.length:0;++j<l;)d=k[j],"undefined"==typeof f[d]&&(f[d]=e[d]);return f}function U(a,b,c){var d,e=a,f=e;if(!e)return f;var g=arguments,h=0,i="number"==typeof c?2:g.length;if(i>3&&"function"==typeof g[i-2])var j=ba(g[--i-1],g[i--],2);else i>2&&"function"==typeof g[i-1]&&(j=g[--i]);for(;++h<i;)if((e=g[h])&&T[typeof e])for(var k=-1,l=T[typeof e]&&Kb(e),m=l?l.length:0;++k<m;)d=l[k],f[d]=j?j(f[d],e[d]):e[d];return f}function W(a){var b,c=[];if(!a||!T[typeof a])return c;for(b in a)rb.call(a,b)&&c.push(b);return c}function X(a){return a&&"object"==typeof a&&!Jb(a)&&rb.call(a,"__wrapped__")?a:new Y(a)}function Y(a,b){this.__chain__=!!b,this.__wrapped__=a}function Z(a){function b(){if(d){var a=l(d);sb.apply(a,arguments)}if(this instanceof b){var f=aa(c.prototype),a=c.apply(f,a||arguments);return va(a)?a:f}return c.apply(e,a||arguments)}var c=a[0],d=a[2],e=a[4];return Ib(b,a),b}function _(a,b,c,d,e){if(c){var f=c(a);if("undefined"!=typeof f)return f}if(!va(a))return a;var g=kb.call(a);if(!Q[g])return a;var i=Gb[g];switch(g){case J:case K:return new i(+a);case M:case P:return new i(a);case O:return f=i(a.source,z.exec(a)),f.lastIndex=a.lastIndex,f}if(g=Jb(a),b){var k=!d;d||(d=h()),e||(e=h());for(var m=d.length;m--;)if(d[m]==a)return e[m];f=g?i(a.length):{}}else f=g?l(a):U({},a);return g&&(rb.call(a,"index")&&(f.index=a.index),rb.call(a,"input")&&(f.input=a.input)),b?(d.push(a),e.push(f),(g?Da:o)(a,function(a,g){f[g]=_(a,b,c,d,e)}),k&&(j(d),j(e)),f):f}function aa(a){return va(a)?xb(a):{}}function ba(a,b,c){if("function"!=typeof a)return Ua;if("undefined"==typeof b||!("prototype"in a))return a;var d=a.__bindData__;if("undefined"==typeof d&&(Hb.funcNames&&(d=!a.name),d=d||!Hb.funcDecomp,!d)){var e=pb.call(a);Hb.funcNames||(d=!A.test(e)),d||(d=E.test(e),Ib(a,d))}if(!1===d||!0!==d&&1&d[1])return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return Sa(a,b)}function ca(a){function b(){var a=i?g:this;if(e){var o=l(e);sb.apply(o,arguments)}return(f||k)&&(o||(o=l(arguments)),f&&sb.apply(o,f),k&&o.length<h)?(d|=16,ca([c,m?d:-4&d,o,null,g,h])):(o||(o=arguments),j&&(c=a[n]),this instanceof b?(a=aa(c.prototype),o=c.apply(a,o),va(o)?o:a):c.apply(a,o))}var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=1&d,j=2&d,k=4&d,m=8&d,n=c;return Ib(b,a),b}function da(c,d){var e=-1,g=ma(),h=c?c.length:0,i=h>=s&&g===a,j=[];if(i){var l=f(d);l?(g=b,d=l):i=!1}for(;++e<h;)l=c[e],0>g(d,l)&&j.push(l);return i&&k(d),j}function ea(a,b,c,d){d=(d||0)-1;for(var e=a?a.length:0,f=[];++d<e;){var g=a[d];if(g&&"object"==typeof g&&"number"==typeof g.length&&(Jb(g)||qa(g))){b||(g=ea(g,b,c));var h=-1,i=g.length,j=f.length;for(f.length+=i;++h<i;)f[j++]=g[h]}else c||f.push(g)}return f}function fa(a,b,c,d,e,f){if(c){var g=c(a,b);if("undefined"!=typeof g)return!!g}if(a===b)return 0!==a||1/a==1/b;if(a===a&&!(a&&T[typeof a]||b&&T[typeof b]))return!1;if(null==a||null==b)return a===b;var i=kb.call(a),k=kb.call(b);if(i==H&&(i=N),k==H&&(k=N),i!=k)return!1;switch(i){case J:case K:return+a==+b;case M:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case O:case P:return a==fb(b)}if(k=i==I,!k){var l=rb.call(a,"__wrapped__"),m=rb.call(b,"__wrapped__");if(l||m)return fa(l?a.__wrapped__:a,m?b.__wrapped__:b,c,d,e,f);if(i!=N)return!1;if(i=a.constructor,l=b.constructor,i!=l&&!(ua(i)&&i instanceof i&&ua(l)&&l instanceof l)&&"constructor"in a&&"constructor"in b)return!1}for(i=!e,e||(e=h()),f||(f=h()),l=e.length;l--;)if(e[l]==a)return f[l]==b;var n=0,g=!0;if(e.push(a),f.push(b),k){if(l=a.length,n=b.length,(g=n==l)||d)for(;n--;)if(k=l,m=b[n],d)for(;k--&&!(g=fa(a[k],m,c,d,e,f)););else if(!(g=fa(a[n],m,c,d,e,f)))break}else p(b,function(b,h,i){return rb.call(i,h)?(n++,g=rb.call(a,h)&&fa(a[h],b,c,d,e,f)):void 0}),g&&!d&&p(a,function(a,b,c){return rb.call(c,b)?g=-1<--n:void 0});return e.pop(),f.pop(),i&&(j(e),j(f)),g}function ga(a,b,c,d,e){(Jb(b)?Da:o)(b,function(b,f){var g,h,i=b,j=a[f];if(b&&((h=Jb(b))||Pb(b))){for(i=d.length;i--;)if(g=d[i]==b){j=e[i];break}if(!g){var k;c&&(i=c(j,b),k="undefined"!=typeof i)&&(j=i),k||(j=h?Jb(j)?j:[]:Pb(j)?j:{}),d.push(b),e.push(j),k||ga(j,b,c,d,e)}}else c&&(i=c(j,b),"undefined"==typeof i&&(i=b)),"undefined"!=typeof i&&(j=i);a[f]=j})}function ha(a,b){return a+ob(Fb()*(b-a+1))}function ia(c,d,e){var g=-1,i=ma(),l=c?c.length:0,m=[],n=!d&&l>=s&&i===a,o=e||n?h():m;
for(n&&(o=f(o),i=b);++g<l;){var p=c[g],q=e?e(p,g,c):p;(d?!g||o[o.length-1]!==q:0>i(o,q))&&((e||n)&&o.push(q),m.push(p))}return n?(j(o.k),k(o)):e&&j(o),m}function ja(a){return function(b,c,d){var e={};c=X.createCallback(c,d,3),d=-1;var f=b?b.length:0;if("number"==typeof f)for(;++d<f;){var g=b[d];a(e,g,c(g,d,b),b)}else o(b,function(b,d,f){a(e,b,c(b,d,f),f)});return e}}function ka(a,b,c,d,e,f){var g=1&b,h=4&b,i=16&b,j=32&b;if(!(2&b||ua(a)))throw new gb;i&&!c.length&&(b&=-17,i=c=!1),j&&!d.length&&(b&=-33,j=d=!1);var k=a&&a.__bindData__;return k&&!0!==k?(k=l(k),k[2]&&(k[2]=l(k[2])),k[3]&&(k[3]=l(k[3])),!g||1&k[1]||(k[4]=e),!g&&1&k[1]&&(b|=8),!h||4&k[1]||(k[5]=f),i&&sb.apply(k[2]||(k[2]=[]),c),j&&vb.apply(k[3]||(k[3]=[]),d),k[1]|=b,ka.apply(null,k)):(1==b||17===b?Z:ca)([a,b,c,d,e,f])}function la(a){return Lb[a]}function ma(){var b=(b=X.indexOf)===Ma?a:b;return b}function na(a){return"function"==typeof a&&lb.test(a)}function oa(a){var b,c;return a&&kb.call(a)==N&&(b=a.constructor,!ua(b)||b instanceof b)?(p(a,function(a,b){c=b}),"undefined"==typeof c||rb.call(a,c)):!1}function pa(a){return Mb[a]}function qa(a){return a&&"object"==typeof a&&"number"==typeof a.length&&kb.call(a)==H||!1}function ra(a,b,c){var d=Kb(a),e=d.length;for(b=ba(b,c,3);e--&&(c=d[e],!1!==b(a[c],c,a)););return a}function sa(a){var b=[];return p(a,function(a,c){ua(a)&&b.push(c)}),b.sort()}function ta(a){for(var b=-1,c=Kb(a),d=c.length,e={};++b<d;){var f=c[b];e[a[f]]=f}return e}function ua(a){return"function"==typeof a}function va(a){return!(!a||!T[typeof a])}function wa(a){return"number"==typeof a||a&&"object"==typeof a&&kb.call(a)==M||!1}function xa(a){return"string"==typeof a||a&&"object"==typeof a&&kb.call(a)==P||!1}function ya(a){for(var b=-1,c=Kb(a),d=c.length,e=Za(d);++b<d;)e[b]=a[c[b]];return e}function za(a,b,c){var d=-1,e=ma(),f=a?a.length:0,g=!1;return c=(0>c?Cb(0,f+c):c)||0,Jb(a)?g=-1<e(a,b,c):"number"==typeof f?g=-1<(xa(a)?a.indexOf(b,c):e(a,b,c)):o(a,function(a){return++d<c?void 0:!(g=a===b)}),g}function Aa(a,b,c){var d=!0;b=X.createCallback(b,c,3),c=-1;var e=a?a.length:0;if("number"==typeof e)for(;++c<e&&(d=!!b(a[c],c,a)););else o(a,function(a,c,e){return d=!!b(a,c,e)});return d}function Ba(a,b,c){var d=[];b=X.createCallback(b,c,3),c=-1;var e=a?a.length:0;if("number"==typeof e)for(;++c<e;){var f=a[c];b(f,c,a)&&d.push(f)}else o(a,function(a,c,e){b(a,c,e)&&d.push(a)});return d}function Ca(a,b,c){b=X.createCallback(b,c,3),c=-1;var d=a?a.length:0;if("number"!=typeof d){var e;return o(a,function(a,c,d){return b(a,c,d)?(e=a,!1):void 0}),e}for(;++c<d;){var f=a[c];if(b(f,c,a))return f}}function Da(a,b,c){var d=-1,e=a?a.length:0;if(b=b&&"undefined"==typeof c?b:ba(b,c,3),"number"==typeof e)for(;++d<e&&!1!==b(a[d],d,a););else o(a,b);return a}function Ea(a,b,c){var d=a?a.length:0;if(b=b&&"undefined"==typeof c?b:ba(b,c,3),"number"==typeof d)for(;d--&&!1!==b(a[d],d,a););else{var e=Kb(a),d=e.length;o(a,function(a,c,f){return c=e?e[--d]:--d,b(f[c],c,f)})}return a}function Fa(a,b,c){var d=-1,e=a?a.length:0;if(b=X.createCallback(b,c,3),"number"==typeof e)for(var f=Za(e);++d<e;)f[d]=b(a[d],d,a);else f=[],o(a,function(a,c,e){f[++d]=b(a,c,e)});return f}function Ga(a,b,c){var e=-1/0,f=e;if("function"!=typeof b&&c&&c[b]===a&&(b=null),null==b&&Jb(a)){c=-1;for(var g=a.length;++c<g;){var h=a[c];h>f&&(f=h)}}else b=null==b&&xa(a)?d:X.createCallback(b,c,3),Da(a,function(a,c,d){c=b(a,c,d),c>e&&(e=c,f=a)});return f}function Ha(a,b,c,d){if(!a)return c;var e=3>arguments.length;b=X.createCallback(b,d,4);var f=-1,g=a.length;if("number"==typeof g)for(e&&(c=a[++f]);++f<g;)c=b(c,a[f],f,a);else o(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)});return c}function Ia(a,b,c,d){var e=3>arguments.length;return b=X.createCallback(b,d,4),Ea(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)}),c}function Ja(a){var b=-1,c=a?a.length:0,d=Za("number"==typeof c?c:0);return Da(a,function(a){var c=ha(0,++b);d[b]=d[c],d[c]=a}),d}function Ka(a,b,c){var d;b=X.createCallback(b,c,3),c=-1;var e=a?a.length:0;if("number"==typeof e)for(;++c<e&&!(d=b(a[c],c,a)););else o(a,function(a,c,e){return!(d=b(a,c,e))});return!!d}function La(a,b,c){var d=0,e=a?a.length:0;if("number"!=typeof b&&null!=b){var f=-1;for(b=X.createCallback(b,c,3);++f<e&&b(a[f],f,a);)d++}else if(d=b,null==d||c)return a?a[0]:n;return l(a,0,Db(Cb(0,d),e))}function Ma(b,c,d){if("number"==typeof d){var e=b?b.length:0;d=0>d?Cb(0,e+d):d||0}else if(d)return d=Oa(b,c),b[d]===c?d:-1;return a(b,c,d)}function Na(a,b,c){if("number"!=typeof b&&null!=b){var d=0,e=-1,f=a?a.length:0;for(b=X.createCallback(b,c,3);++e<f&&b(a[e],e,a);)d++}else d=null==b||c?1:Cb(0,b);return l(a,d)}function Oa(a,b,c,d){var e=0,f=a?a.length:e;for(c=c?X.createCallback(c,d,1):Ua,b=c(b);f>e;)d=e+f>>>1,c(a[d])<b?e=d+1:f=d;return e}function Pa(a,b,c,d){return"boolean"!=typeof b&&null!=b&&(d=c,c="function"!=typeof b&&d&&d[b]===a?null:b,b=!1),null!=c&&(c=X.createCallback(c,d,3)),ia(a,b,c)}function Qa(){for(var a=1<arguments.length?arguments:arguments[0],b=-1,c=a?Ga(Tb(a,"length")):0,d=Za(0>c?0:c);++b<c;)d[b]=Tb(a,b);return d}function Ra(a,b){var c=-1,d=a?a.length:0,e={};for(b||!d||Jb(a[0])||(b=[]);++c<d;){var f=a[c];b?e[f]=b[c]:f&&(e[f[0]]=f[1])}return e}function Sa(a,b){return 2<arguments.length?ka(a,17,l(arguments,2),null,b):ka(a,1,null,null,b)}function Ta(a,b,c){function d(){k&&nb(k),g=k=l=n,(p||o!==b)&&(m=Ub(),h=a.apply(j,f),k||g||(f=j=null))}function e(){var c=b-(Ub()-i);c>0?k=tb(e,c):(g&&nb(g),c=l,g=k=l=n,c&&(m=Ub(),h=a.apply(j,f),k||g||(f=j=null)))}var f,g,h,i,j,k,l,m=0,o=!1,p=!0;if(!ua(a))throw new gb;if(b=Cb(0,b)||0,!0===c)var q=!0,p=!1;else va(c)&&(q=c.leading,o="maxWait"in c&&(Cb(b,c.maxWait)||0),p="trailing"in c?c.trailing:p);return function(){if(f=arguments,i=Ub(),j=this,l=p&&(k||!q),!1===o)var c=q&&!k;else{g||q||(m=i);var n=o-(i-m),r=0>=n;r?(g&&(g=nb(g)),m=i,h=a.apply(j,f)):g||(g=tb(d,n))}return r&&k?k=nb(k):k||b===o||(k=tb(e,b)),c&&(r=!0,h=a.apply(j,f)),!r||k||g||(f=j=null),h}}function Ua(a){return a}function Va(a,b,c){var d=!0,e=b&&sa(b);b&&(c||e.length)||(null==c&&(c=b),f=Y,b=a,a=X,e=sa(b)),!1===c?d=!1:va(c)&&"chain"in c&&(d=c.chain);var f=a,g=ua(f);Da(e,function(c){var e=a[c]=b[c];g&&(f.prototype[c]=function(){var b=this.__chain__,c=this.__wrapped__,g=[c];if(sb.apply(g,arguments),g=e.apply(a,g),d||b){if(c===g&&va(g))return this;g=new f(g),g.__chain__=b}return g})})}function Wa(){}function Xa(a){return function(b){return b[a]}}function Ya(){return this.__wrapped__}c=c?$.defaults(V.Object(),c,$.pick(V,G)):V;var Za=c.Array,$a=c.Boolean,_a=c.Date,ab=c.Function,bb=c.Math,cb=c.Number,db=c.Object,eb=c.RegExp,fb=c.String,gb=c.TypeError,hb=[],ib=db.prototype,jb=c._,kb=ib.toString,lb=eb("^"+fb(kb).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),mb=bb.ceil,nb=c.clearTimeout,ob=bb.floor,pb=ab.prototype.toString,qb=na(qb=db.getPrototypeOf)&&qb,rb=ib.hasOwnProperty,sb=hb.push,tb=c.setTimeout,ub=hb.splice,vb=hb.unshift,wb=function(){try{var a={},b=na(b=db.defineProperty)&&b,c=b(a,a,a)&&b}catch(d){}return c}(),xb=na(xb=db.create)&&xb,yb=na(yb=Za.isArray)&&yb,zb=c.isFinite,Ab=c.isNaN,Bb=na(Bb=db.keys)&&Bb,Cb=bb.max,Db=bb.min,Eb=c.parseInt,Fb=bb.random,Gb={};Gb[I]=Za,Gb[J]=$a,Gb[K]=_a,Gb[L]=ab,Gb[N]=db,Gb[M]=cb,Gb[O]=eb,Gb[P]=fb,Y.prototype=X.prototype;var Hb=X.support={};Hb.funcDecomp=!na(c.a)&&E.test(m),Hb.funcNames="string"==typeof ab.name,X.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:B,variable:"",imports:{_:X}},xb||(aa=function(){function a(){}return function(b){if(va(b)){a.prototype=b;var d=new a;a.prototype=null}return d||c.Object()}}());var Ib=wb?function(a,b){S.value=b,wb(a,"__bindData__",S)}:Wa,Jb=yb||function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&kb.call(a)==I||!1},Kb=Bb?function(a){return va(a)?Bb(a):[]}:W,Lb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Mb=ta(Lb),Nb=eb("("+Kb(Mb).join("|")+")","g"),Ob=eb("["+Kb(Lb).join("")+"]","g"),Pb=qb?function(a){if(!a||kb.call(a)!=N)return!1;var b=a.valueOf,c=na(b)&&(c=qb(b))&&qb(c);return c?a==c||qb(a)==c:oa(a)}:oa,Qb=ja(function(a,b,c){rb.call(a,c)?a[c]++:a[c]=1}),Rb=ja(function(a,b,c){(rb.call(a,c)?a[c]:a[c]=[]).push(b)}),Sb=ja(function(a,b,c){a[c]=b}),Tb=Fa,Ub=na(Ub=_a.now)&&Ub||function(){return(new _a).getTime()},Vb=8==Eb(u+"08")?Eb:function(a,b){return Eb(xa(a)?a.replace(C,""):a,b||0)};return X.after=function(a,b){if(!ua(b))throw new gb;return function(){return 1>--a?b.apply(this,arguments):void 0}},X.assign=U,X.at=function(a){for(var b=arguments,c=-1,d=ea(b,!0,!1,1),b=b[2]&&b[2][b[1]]===a?1:d.length,e=Za(b);++c<b;)e[c]=a[d[c]];return e},X.bind=Sa,X.bindAll=function(a){for(var b=1<arguments.length?ea(arguments,!0,!1,1):sa(a),c=-1,d=b.length;++c<d;){var e=b[c];a[e]=ka(a[e],1,null,null,a)}return a},X.bindKey=function(a,b){return 2<arguments.length?ka(b,19,l(arguments,2),null,a):ka(b,3,null,null,a)},X.chain=function(a){return a=new Y(a),a.__chain__=!0,a},X.compact=function(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d},X.compose=function(){for(var a=arguments,b=a.length;b--;)if(!ua(a[b]))throw new gb;return function(){for(var b=arguments,c=a.length;c--;)b=[a[c].apply(this,b)];return b[0]}},X.constant=function(a){return function(){return a}},X.countBy=Qb,X.create=function(a,b){var c=aa(a);return b?U(c,b):c},X.createCallback=function(a,b,c){var d=typeof a;if(null==a||"function"==d)return ba(a,b,c);if("object"!=d)return Xa(a);var e=Kb(a),f=e[0],g=a[f];return 1!=e.length||g!==g||va(g)?function(b){for(var c=e.length,d=!1;c--&&(d=fa(b[e[c]],a[e[c]],null,!0)););return d}:function(a){return a=a[f],g===a&&(0!==g||1/g==1/a)}},X.curry=function(a,b){return b="number"==typeof b?b:+b||a.length,ka(a,4,null,null,null,b)},X.debounce=Ta,X.defaults=t,X.defer=function(a){if(!ua(a))throw new gb;var b=l(arguments,1);return tb(function(){a.apply(n,b)},1)},X.delay=function(a,b){if(!ua(a))throw new gb;var c=l(arguments,2);return tb(function(){a.apply(n,c)},b)},X.difference=function(a){return da(a,ea(arguments,!0,!0,1))},X.filter=Ba,X.flatten=function(a,b,c,d){return"boolean"!=typeof b&&null!=b&&(d=c,c="function"!=typeof b&&d&&d[b]===a?null:b,b=!1),null!=c&&(a=Fa(a,c,d)),ea(a,b)},X.forEach=Da,X.forEachRight=Ea,X.forIn=p,X.forInRight=function(a,b,c){var d=[];p(a,function(a,b){d.push(b,a)});var e=d.length;for(b=ba(b,c,3);e--&&!1!==b(d[e--],d[e],a););return a},X.forOwn=o,X.forOwnRight=ra,X.functions=sa,X.groupBy=Rb,X.indexBy=Sb,X.initial=function(a,b,c){var d=0,e=a?a.length:0;if("number"!=typeof b&&null!=b){var f=e;for(b=X.createCallback(b,c,3);f--&&b(a[f],f,a);)d++}else d=null==b||c?1:b||d;return l(a,0,Db(Cb(0,e-d),e))},X.intersection=function(){for(var c=[],d=-1,e=arguments.length,g=h(),i=ma(),l=i===a,m=h();++d<e;){var n=arguments[d];(Jb(n)||qa(n))&&(c.push(n),g.push(l&&n.length>=s&&f(d?c[d]:m)))}var l=c[0],o=-1,p=l?l.length:0,q=[];a:for(;++o<p;){var r=g[0],n=l[o];if(0>(r?b(r,n):i(m,n))){for(d=e,(r||m).push(n);--d;)if(r=g[d],0>(r?b(r,n):i(c[d],n)))continue a;q.push(n)}}for(;e--;)(r=g[e])&&k(r);return j(g),j(m),q},X.invert=ta,X.invoke=function(a,b){var c=l(arguments,2),d=-1,e="function"==typeof b,f=a?a.length:0,g=Za("number"==typeof f?f:0);return Da(a,function(a){g[++d]=(e?b:a[b]).apply(a,c)}),g},X.keys=Kb,X.map=Fa,X.mapValues=function(a,b,c){var d={};return b=X.createCallback(b,c,3),o(a,function(a,c,e){d[c]=b(a,c,e)}),d},X.max=Ga,X.memoize=function(a,b){function c(){var d=c.cache,e=b?b.apply(this,arguments):r+arguments[0];return rb.call(d,e)?d[e]:d[e]=a.apply(this,arguments)}if(!ua(a))throw new gb;return c.cache={},c},X.merge=function(a){var b=arguments,c=2;if(!va(a))return a;if("number"!=typeof b[2]&&(c=b.length),c>3&&"function"==typeof b[c-2])var d=ba(b[--c-1],b[c--],2);else c>2&&"function"==typeof b[c-1]&&(d=b[--c]);for(var b=l(arguments,1,c),e=-1,f=h(),g=h();++e<c;)ga(a,b[e],d,f,g);return j(f),j(g),a},X.min=function(a,b,c){var e=1/0,f=e;if("function"!=typeof b&&c&&c[b]===a&&(b=null),null==b&&Jb(a)){c=-1;for(var g=a.length;++c<g;){var h=a[c];f>h&&(f=h)}}else b=null==b&&xa(a)?d:X.createCallback(b,c,3),Da(a,function(a,c,d){c=b(a,c,d),e>c&&(e=c,f=a)});return f},X.omit=function(a,b,c){var d={};if("function"!=typeof b){var e=[];p(a,function(a,b){e.push(b)});for(var e=da(e,ea(arguments,!0,!1,1)),f=-1,g=e.length;++f<g;){var h=e[f];d[h]=a[h]}}else b=X.createCallback(b,c,3),p(a,function(a,c,e){b(a,c,e)||(d[c]=a)});return d},X.once=function(a){var b,c;if(!ua(a))throw new gb;return function(){return b?c:(b=!0,c=a.apply(this,arguments),a=null,c)}},X.pairs=function(a){for(var b=-1,c=Kb(a),d=c.length,e=Za(d);++b<d;){var f=c[b];e[b]=[f,a[f]]}return e},X.partial=function(a){return ka(a,16,l(arguments,1))},X.partialRight=function(a){return ka(a,32,null,l(arguments,1))},X.pick=function(a,b,c){var d={};if("function"!=typeof b)for(var e=-1,f=ea(arguments,!0,!1,1),g=va(a)?f.length:0;++e<g;){var h=f[e];h in a&&(d[h]=a[h])}else b=X.createCallback(b,c,3),p(a,function(a,c,e){b(a,c,e)&&(d[c]=a)});return d},X.pluck=Tb,X.property=Xa,X.pull=function(a){for(var b=arguments,c=0,d=b.length,e=a?a.length:0;++c<d;)for(var f=-1,g=b[c];++f<e;)a[f]===g&&(ub.call(a,f--,1),e--);return a},X.range=function(a,b,c){a=+a||0,c="number"==typeof c?c:+c||1,null==b&&(b=a,a=0);var d=-1;b=Cb(0,mb((b-a)/(c||1)));for(var e=Za(b);++d<b;)e[d]=a,a+=c;return e},X.reject=function(a,b,c){return b=X.createCallback(b,c,3),Ba(a,function(a,c,d){return!b(a,c,d)})},X.remove=function(a,b,c){var d=-1,e=a?a.length:0,f=[];for(b=X.createCallback(b,c,3);++d<e;)c=a[d],b(c,d,a)&&(f.push(c),ub.call(a,d--,1),e--);return f},X.rest=Na,X.shuffle=Ja,X.sortBy=function(a,b,c){var d=-1,f=Jb(b),g=a?a.length:0,l=Za("number"==typeof g?g:0);for(f||(b=X.createCallback(b,c,3)),Da(a,function(a,c,e){var g=l[++d]=i();f?g.m=Fa(b,function(b){return a[b]}):(g.m=h())[0]=b(a,c,e),g.n=d,g.o=a}),g=l.length,l.sort(e);g--;)a=l[g],l[g]=a.o,f||j(a.m),k(a);return l},X.tap=function(a,b){return b(a),a},X.throttle=function(a,b,c){var d=!0,e=!0;if(!ua(a))throw new gb;return!1===c?d=!1:va(c)&&(d="leading"in c?c.leading:d,e="trailing"in c?c.trailing:e),R.leading=d,R.maxWait=b,R.trailing=e,Ta(a,b,R)},X.times=function(a,b,c){a=-1<(a=+a)?a:0;var d=-1,e=Za(a);for(b=ba(b,c,1);++d<a;)e[d]=b(d);return e},X.toArray=function(a){return a&&"number"==typeof a.length?l(a):ya(a)},X.transform=function(a,b,c,d){var e=Jb(a);if(null==c)if(e)c=[];else{var f=a&&a.constructor;c=aa(f&&f.prototype)}return b&&(b=X.createCallback(b,d,4),(e?Da:o)(a,function(a,d,e){return b(c,a,d,e)})),c},X.union=function(){return ia(ea(arguments,!0,!0))},X.uniq=Pa,X.values=ya,X.where=Ba,X.without=function(a){return da(a,l(arguments,1))},X.wrap=function(a,b){return ka(b,16,[a])},X.xor=function(){for(var a=-1,b=arguments.length;++a<b;){var c=arguments[a];if(Jb(c)||qa(c))var d=d?ia(da(d,c).concat(da(c,d))):c}return d||[]},X.zip=Qa,X.zipObject=Ra,X.collect=Fa,X.drop=Na,X.each=Da,X.eachRight=Ea,X.extend=U,X.methods=sa,X.object=Ra,X.select=Ba,X.tail=Na,X.unique=Pa,X.unzip=Qa,Va(X),X.clone=function(a,b,c,d){return"boolean"!=typeof b&&null!=b&&(d=c,c=b,b=!1),_(a,b,"function"==typeof c&&ba(c,d,1))},X.cloneDeep=function(a,b,c){return _(a,!0,"function"==typeof b&&ba(b,c,1))},X.contains=za,X.escape=function(a){return null==a?"":fb(a).replace(Ob,la)},X.every=Aa,X.find=Ca,X.findIndex=function(a,b,c){var d=-1,e=a?a.length:0;for(b=X.createCallback(b,c,3);++d<e;)if(b(a[d],d,a))return d;return-1},X.findKey=function(a,b,c){var d;return b=X.createCallback(b,c,3),o(a,function(a,c,e){return b(a,c,e)?(d=c,!1):void 0}),d},X.findLast=function(a,b,c){var d;return b=X.createCallback(b,c,3),Ea(a,function(a,c,e){return b(a,c,e)?(d=a,!1):void 0}),d},X.findLastIndex=function(a,b,c){var d=a?a.length:0;for(b=X.createCallback(b,c,3);d--;)if(b(a[d],d,a))return d;return-1},X.findLastKey=function(a,b,c){var d;return b=X.createCallback(b,c,3),ra(a,function(a,c,e){return b(a,c,e)?(d=c,!1):void 0}),d},X.has=function(a,b){return a?rb.call(a,b):!1},X.identity=Ua,X.indexOf=Ma,X.isArguments=qa,X.isArray=Jb,X.isBoolean=function(a){return!0===a||!1===a||a&&"object"==typeof a&&kb.call(a)==J||!1},X.isDate=function(a){return a&&"object"==typeof a&&kb.call(a)==K||!1},X.isElement=function(a){return a&&1===a.nodeType||!1},X.isEmpty=function(a){var b=!0;if(!a)return b;var c=kb.call(a),d=a.length;return c==I||c==P||c==H||c==N&&"number"==typeof d&&ua(a.splice)?!d:(o(a,function(){return b=!1}),b)},X.isEqual=function(a,b,c,d){return fa(a,b,"function"==typeof c&&ba(c,d,2))},X.isFinite=function(a){return zb(a)&&!Ab(parseFloat(a))},X.isFunction=ua,X.isNaN=function(a){return wa(a)&&a!=+a},X.isNull=function(a){return null===a},X.isNumber=wa,X.isObject=va,X.isPlainObject=Pb,X.isRegExp=function(a){return a&&"object"==typeof a&&kb.call(a)==O||!1},X.isString=xa,X.isUndefined=function(a){return"undefined"==typeof a},X.lastIndexOf=function(a,b,c){var d=a?a.length:0;for("number"==typeof c&&(d=(0>c?Cb(0,d+c):Db(c,d-1))+1);d--;)if(a[d]===b)return d;return-1},X.mixin=Va,X.noConflict=function(){return c._=jb,this},X.noop=Wa,X.now=Ub,X.parseInt=Vb,X.random=function(a,b,c){var d=null==a,e=null==b;return null==c&&("boolean"==typeof a&&e?(c=a,a=1):e||"boolean"!=typeof b||(c=b,e=!0)),d&&e&&(b=1),a=+a||0,e?(b=a,a=0):b=+b||0,c||a%1||b%1?(c=Fb(),Db(a+c*(b-a+parseFloat("1e-"+((c+"").length-1))),b)):ha(a,b)},X.reduce=Ha,X.reduceRight=Ia,X.result=function(a,b){if(a){var c=a[b];return ua(c)?a[b]():c}},X.runInContext=m,X.size=function(a){var b=a?a.length:0;return"number"==typeof b?b:Kb(a).length},X.some=Ka,X.sortedIndex=Oa,X.template=function(a,b,c){var d=X.templateSettings;a=fb(a||""),c=t({},c,d);var e,f=t({},c.imports,d.imports),d=Kb(f),f=ya(f),h=0,i=c.interpolate||D,j="__p+='",i=eb((c.escape||D).source+"|"+i.source+"|"+(i===B?y:D).source+"|"+(c.evaluate||D).source+"|$","g");a.replace(i,function(b,c,d,f,i,k){return d||(d=f),j+=a.slice(h,k).replace(F,g),c&&(j+="'+__e("+c+")+'"),i&&(e=!0,j+="';"+i+";\n__p+='"),d&&(j+="'+((__t=("+d+"))==null?'':__t)+'"),h=k+b.length,b}),j+="';",i=c=c.variable,i||(c="obj",j="with("+c+"){"+j+"}"),j=(e?j.replace(v,""):j).replace(w,"$1").replace(x,"$1;"),j="function("+c+"){"+(i?"":c+"||("+c+"={});")+"var __t,__p='',__e=_.escape"+(e?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+j+"return __p}";try{var k=ab(d,"return "+j).apply(n,f)}catch(l){throw l.source=j,l}return b?k(b):(k.source=j,k)},X.unescape=function(a){return null==a?"":fb(a).replace(Nb,pa)},X.uniqueId=function(a){var b=++q;return fb(null==a?"":a)+b},X.all=Aa,X.any=Ka,X.detect=Ca,X.findWhere=Ca,X.foldl=Ha,X.foldr=Ia,X.include=za,X.inject=Ha,Va(function(){var a={};return o(X,function(b,c){X.prototype[c]||(a[c]=b)}),a}(),!1),X.first=La,X.last=function(a,b,c){var d=0,e=a?a.length:0;if("number"!=typeof b&&null!=b){var f=e;for(b=X.createCallback(b,c,3);f--&&b(a[f],f,a);)d++}else if(d=b,null==d||c)return a?a[e-1]:n;return l(a,Cb(0,e-d))},X.sample=function(a,b,c){return a&&"number"!=typeof a.length&&(a=ya(a)),null==b||c?a?a[ha(0,a.length-1)]:n:(a=Ja(a),a.length=Db(Cb(0,b),a.length),a)},X.take=La,X.head=La,o(X,function(a,b){var c="sample"!==b;X.prototype[b]||(X.prototype[b]=function(b,d){var e=this.__chain__,f=a(this.__wrapped__,b,d);return e||null!=b&&(!d||c&&"function"==typeof b)?new Y(f,e):f})}),X.VERSION="2.4.1",X.prototype.chain=function(){return this.__chain__=!0,this},X.prototype.toString=function(){return fb(this.__wrapped__)},X.prototype.value=Ya,X.prototype.valueOf=Ya,Da(["join","pop","shift"],function(a){var b=hb[a];X.prototype[a]=function(){var a=this.__chain__,c=b.apply(this.__wrapped__,arguments);return a?new Y(c,a):c}}),Da(["push","reverse","sort","unshift"],function(a){var b=hb[a];X.prototype[a]=function(){return b.apply(this.__wrapped__,arguments),this}}),Da(["concat","slice","splice"],function(a){var b=hb[a];X.prototype[a]=function(){return new Y(b.apply(this.__wrapped__,arguments),this.__chain__)}}),X}var n,o=[],p=[],q=0,r=+new Date+"",s=75,t=40,u=" 	\x0B\f\ufeff\n\r\u2028\u2029",v=/\b__p\+='';/g,w=/\b(__p\+=)''\+/g,x=/(__e\(.*?\)|\b__t\))\+'';/g,y=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,z=/\w*$/,A=/^\s*function[ \n\r\t]+\w/,B=/<%=([\s\S]+?)%>/g,C=RegExp("^["+u+"]*0+(?=.$)"),D=/($^)/,E=/\bthis\b/,F=/['\n\r\t\u2028\u2029\\]/g,G="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),H="[object Arguments]",I="[object Array]",J="[object Boolean]",K="[object Date]",L="[object Function]",M="[object Number]",N="[object Object]",O="[object RegExp]",P="[object String]",Q={};Q[L]=!1,Q[H]=Q[I]=Q[J]=Q[K]=Q[M]=Q[N]=Q[O]=Q[P]=!0;var R={leading:!1,maxWait:0,trailing:!1},S={configurable:!1,enumerable:!1,value:null,writable:!1},T={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},U={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},V=T[typeof window]&&window||this,W=T[typeof exports]&&exports&&!exports.nodeType&&exports,X=T[typeof module]&&module&&!module.nodeType&&module,Y=X&&X.exports===W&&W,Z=T[typeof global]&&global;!Z||Z.global!==Z&&Z.window!==Z||(V=Z);var $=m();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(V._=$,define(function(){return $})):W&&X?Y?(X.exports=$)._=$:W._=$:V._=$}.call(this);var map,locations={FirebaseHQ:[6.8632354,79.9528196],Caltrain:[6.8632354,79.9528196]},center=locations.FirebaseHQ,radiusInKm=20,transitFirebaseRef=new Firebase("https://gayan-loction.firebaseio.com/"),geoFire=new GeoFire(transitFirebaseRef.child("_geofire")),vehiclesInQuery={},geoQuery=geoFire.query({center:center,radius:radiusInKm});geoQuery.on("key_entered",function(a,b){a=a.split(":")[1],vehiclesInQuery[a]=!0,transitFirebaseRef.child("identities").child(a).once("value",function(b){vehicle=b.val(),null!==vehicle&&vehiclesInQuery[a]===!0&&(vehiclesInQuery[a]=vehicle,vehicle.marker=createVehicleMarker(vehicle,getVehicleColor(vehicle)))})}),geoQuery.on("key_moved",function(a,b){a=a.split(":")[1];var c=vehiclesInQuery[a];"undefined"!=typeof c&&"undefined"!=typeof c.marker&&c.marker.animatedMoveTo(b)}),geoQuery.on("key_exited",function(a,b){a=a.split(":")[1];var c=vehiclesInQuery[a];c!==!0&&c.marker.setMap(null),delete vehiclesInQuery[a]}),google.maps.Marker.prototype.animatedMoveTo=function(a){var b=a[0],c=a[1],d=this.getPosition().lat(),e=this.getPosition().lng();if(!coordinatesAreEquivalent(d,b)||!coordinatesAreEquivalent(e,c))var f=0,g=b-d,h=c-e,i=window.setInterval(function(){f+=.01;var a=d+f*g,b=e+f*h,c=new google.maps.LatLng(a,b);this.setPosition(c),f>=1&&window.clearInterval(i)}.bind(this),50)};